#include "kernel/types.h"
#include "kernel/stat.h"
#include "user/user.h"
static unsigned long int next = 1;

typedef unsigned int uint32_t;


uint64 data1_cmp[] = {0x9E43B039FCD43A29,0x87384AD77891370C,0x269E6B66947103B3,0x433BB0D6EF63090A,0x778766138380E39D,0xE14A27F6403DC950,0x8BC092A0977E8FFB,0xCFDDB10D9EF89F8B,0xDA7DDBE641695ACC,0x043E695E7D45736C,0x1701A8C830DCDFCA,0xB3FD815023EE2E7F,0x2FDF6DB0B0426436,0x47464F070F7D1C7B,0x093688044627209C,0xB2B6DF315D4DAA14,0x137BF54F8B7FE627,0xD1AF5F74D336D0BC,0x68FC5565E2EF88B0,0x5520BA481ECBBA7D,0x895D05B73E4F96B0,0x21F162413E92ABC1,0x112DA96599A681AD,0x453967A4B89E11B1,0xC1D2C724557778C7,0x45B9E76AB5857A3F,0x9917F80224C21D6E,0x164C296DB0069EE9,0xD36930EC2463E517,0x5A3DE16326378335,0x98B57A1535CD7928,0x80B0E05AA2E13C90,0xAFFA9A13D83A6E3D,0x7FDB1240993689CB,0x6FB7CBD8EADA8D5F,0x7A56CF9839EAE50D,0xD3E09A08F2E690B7,0xB69219FA355FAAD5,0x71833149E5779D15,0x1FBCD89176D98C09,0x116C2EE91FF99441,0x8FACEC53C95B83D5,0xC69CCF5295EB7F67,0x64595D5D1FB077F7,0xBC1BA9F0546CBA70,0x6AB713DDD6721F7D,0x3554C92F95E6F289,0x923B19957A5A39DF,0x1BD5C8CC7D87381B,0xBEBC8E9D738B5D6E,0x462321396CA1F698,0xCDA2488B4E20CB7B,0xB8C6F952AE5AECD5,0xC30A7639027897A0,0xA844382C7D3F78F1,0x1F4B38617961150C,0xCC1FF4A93B7E404D,0xF7F490A393E0493A,0x2653DBB13B36CAEB,0x76B3FCC3EB928B35,0x55F0C4DDF9657673,0x1FE7A1DA5CCEA3EE,0xA3DDE2E72C38A4C2,0x4D2A12E4BF795596,0x2DC997DD243FA207,0x55E9F6642A2E1C06,0xB16522CC3BD3CD02,0x13D6BA341FCA193E,0xD9D03884EA5B5B21,0x68D738DD6BABF051,0x47D7BE4067254A7A,0x198E994EAE83204A,0xA59A0D432998B500,0x4B4492C119CA6474,0xD3793D13E92C933F,0x42C08A955B8FDEB5,0x5AA440649354D8B1,0x6471CAB9FBD558C0,0xA964A5CB40F83945,0xA08656701236CCF5,0xADE2E7F98C7E4DD0,0x33CB03606F84902B,0x44D37AB50392413C,0x84197265E6041885,0x487955D147465C55,0x82DC0C6FB7FF9AC8,0xCCE74AB284D2A2B1,0xAB277C3A2609546C,0xA54458815D2245B7,0xC3FEA01FAA7BC5F2,0x61AEDFF8C87AD935,0xEAA1F8E0C06CE924,0x4A7EAC4302373708,0x00DD76C725E0F319,0x253C7ADEB927E7A3,0xBEB71783B00F2DF6,0x909A12273F39DF02,0xA07567E9E1B040EF,0x5FDEDF6543CDDA61,0x4C872B15F5FBB44A,0x2CD171C0D45D27FA,0x1351BAD22F32B038,0xA44F816BF8AA2D0E,0x4246199A54DA7AF2,0x5CE380F473B11917,0xA3D6ADBDCE1AB7C3,0x64BB409DF1025CD3,0x8495833C1892F389,0xC7BBEEE4DDF4D042,0xC4FDDAEBE6D257E2,0xDF6AA4FC33E83CA2,0x785AD622C7B0B3B5,0xF677D7DED268D9E8,0xB2D57264774094D0,0xF2E8F46368181F0D,0x84A69F71CD7673F1,0x60D4527F2560932F,0x2F544938B3021C64,0xC465364545FC63D5,0xDCC8355690B0361C,0x49985189D4080513,0x4DF9CF15C58350D5,0xE8788D046458CE65,0xDD1AB0D57C2B5385,0xBDDEE1FD4690CDCB,0x303A8024A2B727BA,0x7A062D1FD639D2C7,0x84D617A23483C144,0x934E80834CFC77D3,0x9F9ADFDE4C3CDBD9,0x7889F9578213C688,0x1134463B882D7FAF,0x4858673EEFDB7D09,0xCA1F9775AEEFB645,0x99FA6F1D00967D7C,0xA9588C228DEF88AB,0xD6B626D2D5003634,0x74BAE3F682222906,0xAD25FC75CE850280,0x195B9A9A02216484,0x59AFC115FBF0B97A,0x5EC6DE1B71D2C3F9,0x2A2C54D21A76FD3F,0x5509B6FE147409CC,0xCF8543C26AFDD504,0xA1A10697B2052316,0x814E0511ECF0F42E,0xB706D6F568605F0F,0x9ADFBD6B59149CFE,0x0A80AD00515B9829,0x97F212D25B9D2647,0x93B1CF1627A3067A,0xF586F5C76F3B144A,0x2D38C343606DF1D1,0xCC6992923E067D44,0x65D41401522B90C6,0x0CA56A050C080752,0xF188CACDC0AB3828,0x40EEE4D293C713A2,0xE36FBEEC335EC794,0xB4680DCDD8D5E498,0x505AB0941596E4C9,0x9B54EEDE56EA07F8,0x8B4C1E77DC60C727,0xBC9ACA420F12318E,0xCC47273149972E31,0x2CC090A370B30ED2,0x1C1AA8AAD2567845,0x2DB43987372FEF44,0x4BDAFCDE95D2EB84,0x74CF3CCDE94E91DF,0x6FACF62D613C612B,0x22F36229AA3FC8A0,0x43A3D94BE2D83650,0x418798F1DD186630,0x1E9ECFC926B7879A,0xB85511F1F4E4129F,0x43E998EAE7F322FB,0x6651FE56A6E05666,0x7644858A912BA2BA,0x9107B7B41D3735C6,0x315800157E8AA42F,0x50CA00B7B0E3E437,0x9C142B51DEB95759,0xDDC0B4C2CD0895C4,0xF567B488D9F13FCC,0x4117286379CE3531,0x6EC6DBE0960A9590,0x7C1D73E88AAE0152,0xE30967AA53082B8F,0xE5E25732C686D3EB,0xBC34BC8B868713E4,0x3BB88FE675DA02A5,0xE76970E2A7E9C47C,0xC1F521089B6627A5,0x9E798DF5668AE372,0x0E13A41061201C46,0x669FE5E5A1875FCF,0x6F45BBEDC50E3F2F,0x73C238E6FE94300C,0x9D37C19B325DB1CF,0x88F07BDC58F427FE,0x62109826F65790F7,0x33B793183CA8F465,0xEAD43A5AD70FF434,0xCCE419EA72BDDFF4,0x6734B886500B5F14,0x935F82CCF1BBF3C7,0x25999B0D967EEB9E,0xAF2DCCA757E299B0,0x46069601AE68D675,0x795B88B3FBBA22B6,0x378ED7EB454B021E,0xAA1467B38F84CCCD,0x63C8267EE2968D24,0xCB85C67222821D37,0x400FE4E45B470CD3,0x9539554F05597992,0x354349BEA531AB5A,0x377553EA414E8D2C,0xF88AB8D4544A5D91,0x5B3941723A3E38C1,0xDEA81BA173D683F9,0x7DEEC8D4B43A313B,0xB29D0BBCC82CEF17,0x5EA39E86D65D9825,0x37EF2EC40D6ED23F,0x8167AD308D59E60D,0xDA15F42A2F1BD0A2,0x0D29117CE4CAD4BF,0x04786C779447A32A,0xE20EC093F85CB184,0x9FAA7F8CAE302EEF,0x6E1020D24EB7273E,0x2FABD03F4F1C256C,0xE76D34CB6B1B1636,0x3EC8D5C9BDC06579,0x0409B646A4E7110A,0x6E7881C5297F2A40,0xAD8D3CE3D3ADD0B6,0x6E646E750F929EC9,0x59EA4B6C421D93B7,0x313B6988EE42D0FE,0xA02C1563AAA1E536,0x11A987C0EB853546,0x7B2E199571392566,0xCC5E6B25A02438A0,0x24457E5D9D599716,0xE8E70286D3C757AA,0xE55165B0036D7BCC,0x1B8E6EE7576A86A9,0xD6F1FE1B20DE563C,0xC3CCF0664A09003A,0x66B8F65810805B4A,0x3CF5C38B19636B8F,0x7D3FE0B638D54BF4,0x29CA69AE4E7BE9E7,0xAAC2224129BA5C4B,0xD093AB4D97B9D5F7,0x2D1302A72B49288E,0x5D73796DDD7F939B,0xFE90DDC82A809609,0x0B760A372A97C6A0,0x28AE373F58F6707E,0xC70014CF102D274B,0x69C5A172C61661B4,0xAC791442E6B7DA69,0xBAA99787AC89A880,0x831C11EF2254B213,0x7DA6EC8F1FCF874D,0x740F65A2115842CF,0x08FE6BFA73B6CD4D,0x2501345D29F77952,0xDDDC9F18A38646CD,0xE5A263E5FFFFF7C7,0xA4A7BE1B1762F9F3,0x4761724E4B87D733,0x27C3C0B40F2E7866,0xA4AE35D65CC9BDC0,0x3FE0C62586F21622,0x66FE74B5903D0405,0x34640036B7DAFB62,0x3C55E2963817B0FA,0x2EDA3A00F2F074B5,0xF7C6863655C97539,0xBE55F4A2C4E7B9AF,0x32953CD5798421BD,0xDF23CAEE5902AE56,0x8AFA5FD2CC6B2802,0x0756C1BD632F5418,0x87A1C574F036E533,0xAE5E243B8C52F356,0xDADC027CF7507142,0xDE61555C0EAA7A5C,0x15838D2E3F7A2CB5,0x357CC8510491F419,0x849E1E229E3FBBC6,0x72482822C3397571,0x9859EDA0693E19EF,0xA43B06384DE44E91,0x581FB80A2B123192,0xC7051E09279B7C17,0x1E284A61BFEC2D18,0xA411D3C7BEAEE975,0x1BD5C8CC7D87381B,0xBEBC8E9D738B5D6E,0x462321396CA1F698,0xCDA2488B4E20CB7B,0xB8C6F952AE5AECD5,0xC30A7639027897A0,0xA844382C7D3F78F1,0x1F4B38617961150C,0xCC1FF4A93B7E404D,0xF7F490A393E0493A,0x2653DBB13B36CAEB,0x76B3FCC3EB928B35,0x55F0C4DDF9657673,0x1FE7A1DA5CCEA3EE,0xA3DDE2E72C38A4C2,0x4D2A12E4BF795596,0x99171BF213EED155,0xBC24922EC06F4B0B,0x541244725A6E38AA,0x48583FACD3FD0408,0xBB5AA7519CB840C4,0x50B3EBC64EA2AA48,0x579F827A10D7A344,0x9BC714320E6835A2,0xFDD8654D15235D7D,0x8DC18608DE9B41DE,0xBF95A0E3168E91D0,0x740C6428650A826E,0x110831D98450CCA6,0x61468D32DCFB2C53,0x612414AD46AD9325,0xADDA1F25AC775D9F,0xA239DBD7FAB35A22,0xC068CC9F7B513E8B,0x28FCA9E1E9928CC9,0x5BCDCED1C436E459,0xD48BEB05ACC3AAF7,0x26D2FA51B752131E,0x23218F22F57DFBF8,0xD6BDD87F5B2BB39A,0x9BB6C0EC44F6F422,0xE04A71294CD9480E,0xB80B6A5E93CA77DD,0x8E01A16DC1BAAAE9,0xFB72C2D508AB7E87,0xEA91A7094540AF4C,0x65C3CAF3DCCBE283,0xCD8D0B813B786134,0x35AD7404B2797AF2,0x5CE03D6F81AAD01F,0x25270E2284D5BC1E,0xC6E6C274F5D90105,0xBEDE5114FF7213A1,0x59B1D49428D2BA1D,0x60FA9ED613383CB3,0x6D049139338F109C,0xD7AF60BA56149192,0x4A512C8394755AA2,0xCC452A3481D90AB5,0xEA3B4F7E7C20C879,0x3291264D53385EE4,0x483C310756DAE2E6,0x0332FBBBFFA0D49E,0x19DF89C8DFD1C471,0x6E646E750F929EC9,0x59EA4B6C421D93B7,0x313B6988EE42D0FE,0xA02C1563AAA1E536,0x11A987C0EB853546,0x7B2E199571392566,0xCC5E6B25A02438A0,0x24457E5D9D599716,0xE8E70286D3C757AA,0xE55165B0036D7BCC,0x1B8E6EE7576A86A9,0xD6F1FE1B20DE563C,0xC3CCF0664A09003A,0x66B8F65810805B4A,0x3CF5C38B19636B8F,0x7D3FE0B638D54BF4,0xD54FBECE2EEF667F,0xEF7C91432F1882AD,0x964A18A3DFBD7965,0x4013128219F2690C,0x428DEE68CA539C2A,0x6FCB317BB8F96A28,0xF2325D594C04A2E2,0xCA769F1CEF85D8C0,0x624D95671FAE79A0,0x29E837DB37BB60FC,0xCDAC385D45E50BF5,0x450EB7E4A1A2B83A,0xBFC7AA4E97D16F16,0xD9A65277844E49CC,0xEA6EB9088A141CEB,0xD532AAD950B5690E,0x4A552FE91492704D,0x83E5B502D89D56AC,0x2D5321805FA89811,0x07A5CAE35C1111DD,0xE3A3D2C73A111119,0xDE1CF2B46DF3BB4D,0xE3D89199178D18A5,0xCFFD109D9F718EEC,0x3AE5895219BC8EC5,0xFAC14B78B4450FF5,0x5CD12C14DFC2F316,0xB3FB604978CFFEA0,0xCC97C930E9751E71,0x5426194C2D111C32,0x46E7C0E286B765A4,0x8420323827ED8BC1,0x09EEB6A61D2B4E47,0xCD37424EB7B4EF3D,0xAF4CEEE98BB8E526,0xF7230AA3CAEFEF28,0x94B32D4D502B8245,0x8B4EF3E8E982D6BB,0xA2B85414B7373E8A,0xD9CF73A417260D47,0x4DBF2448436D0040,0x0D48929F97479DAF,0x9DDBB10342AC518F,0x89171ED8453E6768,0xEDB2820DA45EE8CF,0x1C91E7E4A00C0650,0xA8D41847AACED0E3,0x93A80FAC46985D68,0xB0A4A93FE4061F3B,0x40C0D5810294D49C,0xF946CD6416FAEFB4,0x187394839B82256C,0x2F4E997F0FA16632,0xDF654DD868745A2E,0xB09D64B7676F8DA8,0xD3C156D690A8FD2E,0xFD9C8F38467E35D1,0x3CE9B0017F25D6CF,0x2EDEC508816AB92A,0xC5E172B993401ED1,0xF38E87A265474F7F,0x69C12C6F60A5635F,0x6F8193324BAFB8A0,0xDA90A6603A002422,0x752AEF14C23F3771,0x44BDDBCC5FB6D9F4,0x0D2332E92156225E,0xF677EBAAA2DF8062,0xC1A9FDE00A0ED65D,0xEEC81A47D1498D34,0x582BDF4CB5F511CA,0x2875052217CBAB7D,0x20D21B093F1FB6E8,0xF8BC596F510FB403,0x25B88605C85DC147,0xDFB10B6209A2EA1A,0x13147E65BD812B8C,0x2C93C2A465F6E216,0x0AAC740948E920F8,0x1E3E8AA1B0F00937,0x71DC0C704B360254,0x7B81D8E7767A7AAC,0x06ECD07FCABC3E55,0x8D8387C3FB994BD4,0x0F575876653AF624,0x9306D0FDB47FB288,0x0249E77B3C6798DA,0xACCFD3E8FE5F101D,0x7D1D3D10C557B6F4,0x81267D5C9C835FF1,0x9248B887B6F23656,0x14BD228A66A18CA3,0xCAE7D3EE999CB583,0x2451FBE2AA898FDE,0xFA9BC2C01D2D4281,0xA9BC180CDD7389D1,0x999886577E1F2CAC,0x9C614B4982102CC9,0x7B725EDC72A21733,0xB1CD9619782DB70B,0x3D82A4090DA2E5A8,0x425F490A3858C3AD,0xA35209236DFFF84E,0x3196101CDC655141,0xB4C0625C90B346AF,0xAAA3C486311805F9,0xE54CA9AADC16E7F1,0x55E89ABBCEFF2C6D,0x51574B5211F79B51,0x8C37FC67DEF92A75,0x0C2D39DC33D0BCF1,0x292C5E68EEB89003,0xE1CF3480C3BE8AB8,0xADCF0DE41373B77A,0xBEAB5DA5167CA26D,0x73B1640480B0CD8E,0x5C88A9C400804681,0xC51F26188E8F779F,0x1B1FD57EAD7CA04F,0xD855DDAE4A97EFC5,0xFEE23778AEE486CF,0x6243F01C384389A4,0xC385E698A03EAC2B,0x8E9AFCA595D4F8AF,0x784713CE23C898EA,0x894CBCA0C89684D1,0x040E79CA149608F8,0x581550215D8F776F};
uint64 data2_cmp[] = {0x2C4104554498C058,0x165797E150494B7E,0xEACE4FEADB6FC73D,0x9892398F392DDC2A,0x8B166517699078A3,0xA615E44512B2C74E,0x5147FCE2DD36CC6C,0x17D51607BFC48FF3,0xB11823A4428D72C9,0xF404FD750903943A,0xDD69A4ADA61D39D4,0xB698B65606CF38C2,0xCAC89888185C67E3,0xFEA85BDD33571646,0x5353D167857C7A23,0x7FB793977DD453F2,0xCD4A5B5AE7B94749,0xB0D7F6D553B3B919,0x72279D7E5ABACD47,0x4528A7B01DD3789D,0x079A66C6EAE06DD9,0x35D03EBD1809B79A,0x85FE349D26C2A464,0x6CD54A02F3A6014C,0x27C2C5E84EC7D183,0xCB9BB97F260F70AD,0x56315C64CA7EA976,0xCA3FB0ACCEB8FEB7,0x5A87364E858E9A4B,0x26FDD11F737DE574,0x4E9506FAB1E6B2C0,0x6FE4131AFE50ECC9,0xEAADABEDCDA44869,0xE7B0BEBE7C92052E,0x4F4AEF1DA4537FBE,0x2D284A20D986FEC1,0x2F038F3E438015E5,0x2E1292787E1D75B5,0x85490CF7A06A47AB,0xD45B4E857D6B0AFD,0xF7EF6C7DCF3CCC07,0xC4569E0C415478DE,0x78284DFFC19DD77B,0xEEFEA4F74878C096,0x4FE48531AB16EE96,0xB5A499F58BFEB8BA,0x75BAC29BF8E58FE2,0x2F69CC0DD10439C0,0x1EE6091E3F2AB14D,0x1723D4BB1CDF63F7,0x105F74CDA5ED3DF0,0xBBA6993D9EA294DE,0xB5BE672A7A59CD08,0x2229D9DA182C1CA8,0x8765F1ACBD77CD83,0x47CF61E69575BF45,0xC37B876C6294BEB4,0xB928FED84454559A,0x26EC5414F6EDB305,0xC0874144E3ACB21E,0x43A9B33A5EAA7A2E,0x879136032B1F31A7,0x332E84B61F6F9349,0x65405BC9756582B9,0xECB52ABC5B48526F,0xBF4A70799CEA3798,0xFED038CD45B23649,0x021E1D33BDAC99CE,0x3507ED81A6D3B2AD,0xF4FCB4394204D8B5,0x170B2F4F5366E085,0x130EB5A56AED1458,0x7C6048258D98356C,0x8649AD5C2A94EBD3,0x9F758CF3D0A0D792,0xE3714C54DE74C6D3,0x12D9B80AFC4E0C40,0xE889446274DC0B29,0xBE2DD67762662999,0x94732D4AF2F825CF,0x04864305F2A53AA6,0x6B84F7802D484B98,0xBE830146931CC96F,0xF3A62BA4CFB86168,0xF7A5479F29A87BBC,0xD1EC8806376C3ED6,0xB77799D11EA1C974,0x492488FCF2528695,0x3B7096B924C19D51,0x5513AE62AEEBAD9C,0x24E7DB582B75B823,0xF9E5455FBA57FFF5,0x5D6A6012C25FD0CF,0xFA050B385E2023C8,0x2FC4C2158CA87D9C,0xCEEE43889722EDDD,0x9AD375FE2D1569FC,0x7D53EB204BE8606F,0x82C86C5BF87B3141,0xF100AEACB29EC4FD,0x16B2A3FEBD7D40B7,0xB81DB46B50A5AE51,0x86A573D58D27FC41,0xE054CE354F3F43A5,0x2FC6A48A93A1CDA2,0x90417AA2A22DF9D9,0x3940520CF3D6D341,0xA7F1F8A6A1A3795B,0x78479E226B4704F0,0xE2E19F7DC5428463,0x7BBE612CFA9F9332,0xAE52EC9BBFB583FE,0x4A8CBE7713A0BD03,0x4B9E769E0C1BE14C,0x23A2097EC2827495,0xDC98FD3E921294A4,0x6755CBC8E7276FF2,0x3F0589035F449D6F,0xF6913F0CD99CF170,0xE1FA186D96AD2098,0x1414F99A556C0D58,0x95578AD2728B2C60,0xE608869F4C8D0102,0xD0C8AFFF93F1E94A,0x1671FBBBD92BA964,0x856CC27D8D12625B,0xB94A87F9D8DEA939,0x0096390DC0DF6AF1,0x2AFEFEE01FFD128C,0x363811AF0F026BB1,0x17B9FBD5EE43BE04,0xB07E5B0F22EF5E3A,0x202E63E13C69175E,0x5D9D9F244C615461,0xEF8CE141661D35E3,0x5AF91DA36C3EFDD4,0xFBC61F7D894B7252,0xCE6F37644626FD66,0x999C38DA18210A23,0x7400B41D23B38D58,0xC03C75E99483249A,0x7198A14297BB8338,0xDE55B1C070E06EE9,0xBB944C5A78CA17BC,0x87A6D48C6BC16A52,0x309783CBC705A852,0xFBEE2AA850C6AF5D,0xCF341EEF5EA75BB5,0x0B443FB2FD30628C,0x9F9C60476EAA42FF,0x835329F3022708F3,0xE4704B95B43E1C7B,0xD27A89F03EFE3B99,0x4FCEB2F73D64AAB1,0x64D57DC86DAE1B91,0x7A2A7D23D56FAEED,0x7F269A6E0573B526,0x9D6D1F1FAEA8E245,0x6980A759812EFD40,0x482E321F9CCA49A7,0xD7F04E545A696915,0xD3F047695BB9FFB7,0xD22423454EF31DDE,0x46884F6156832993,0x734B1DE52DB67AF0,0xACACD996B31AE5EF,0x48664F061E64DFC1,0xCBB76BE0F3E56881,0x1D07CCEB70CC599A,0x0C57715D1ACF23A9,0x7A043026A5E0F467,0x8C046B3E52F9E80A,0x5BC5F9E65628B711,0xBC7016C735D886FE,0x9C9B590CBEA5EA32,0xE3D2656E3DDE7B57,0x5094B7FB57FA29AA,0xBB6AD29E41B292D3,0x8A0BF86FD5AC287A,0x64B4395330154EEC,0x38E389394D6430EC,0xCBCC4B34FA8C3FB1,0x419F0332AF0FEFE8,0x3BABDB4FBD052D22,0x874512E9A7478698,0x20D80874F28663ED,0x65F2BA7193579910,0x1BCD0F4CBE29885F,0x8C0C69ED4A3FB010,0x8C65296F20DB8143,0xC8D77596B4BEA234,0x41EEB8BB384089AA,0x734199D0C5C62B1A,0x1C84F45241FB1F82,0x0795B6FB5A9B3D31,0x2086C612959F3267,0xB599CF183D5D6C1B,0xD320FDBB5960457C,0x516456065692A682,0x1279B06C7B469287,0x24CEA42F8F693EA1,0xA38050A31111894F,0x52770459B5AACBF0,0xE6672405B0183AF5,0x5E605CBBC462D3BB,0x559B023566FAFED9,0x2D43B80BCBE227A2,0x7D6707104211D1B0,0x640AFF37E2C3116B,0x915A38D6E2612AF9,0xEA4CDAE8E97518C3,0xBD4550C904DB3B1A,0x85FC3EFA010FE61C,0x35F87856FC3F8852,0xEE86FF581F0972BC,0xEF1869C0C89CB74E,0x6211F86919F7BF62,0x256A37F2BA59C5DD,0xFD2CBADC4B4E9621,0xE668340A9E551C6E,0x6BF4399E2D1C102B,0x9C19C9A02D9B6044,0xD64958DD2A19287A,0x35EFEA363A83F852,0x34C8861CB5DBEBA2,0x2F8D0A75E957A4BC,0x8397B16FC190539F,0x2F4659711F5A288A,0x6346265FA32329CA,0x369EA2549A70FE07,0xC49EB9AEAAFDEAAC,0x11A300852099AFD3,0x8882AF768C0225AA,0xB9CC73489A1000EA,0x85E5726DF2B973BE,0x34307657288BBE80,0x37068E7F940E3048,0x8D31CAA7D95FB400,0x10B88B059CA642E2,0xA276561AA022BC2A,0xE750B8EA3B3FB7AD,0x0B4835C07615F595,0x3A882C4A45E4EDF3,0x6DCD424353DE4E02,0x578413DADD65FE4C,0xE1E296DF86CDD1F6,0xA94E5C7BA08EC1AB,0xA40A02C41F472CEE,0xCE9A0ACE56FA9DA4,0xE66E9C0A32FCD9B8,0x39A6AC90321442F8,0x8B1663FBF7A3054E,0x14A4C2928B5ACD42,0xA84CBFAEA26C3C21,0xAF3D3B93FC144B36,0xC09ADA76D450E495,0xFC68F06A6C80EDF3,0x551E1CDD4B9C4D1E,0xB05C34AFDA8CBC0A,0xBE414E0C19CC783F,0x85F6C4A5C233271B,0x18E2BCDBD27B55F3,0x2A303763C44306B1,0xA4A621A8854FFF98,0xEEAFBB25F456DEA1,0x5C72D74B10560C6C,0x8239E4E73B4203CA,0x82998C97D05A6DFF,0x0CAF5D197D2C7232,0x91189CBBCB0BC51C,0x4AC4EC73CE5A46B7,0x82E245A251BE1FE4,0x97ED2F1F699E0B09,0x6460C937050FEA90,0xD9D749EDD7626F03,0x6121628602558404,0xE369284CAF3BB4D2,0x3272164B20B6ACD8,0x0D674E57CE5456EB,0x4D8E97A7B6EE2A3E,0x1544C209DE0BDCFB,0x223BAE377C6F0976,0x25DE3CCAC5AED73A,0x6AF1F25A8E4A6DBD,0x37BB73CBFED7F252,0xB87A6467A2FE48D5,0x15194A4095C48E82,0xF184034C882A5220,0xA315F428696C0917,0x03EE4D7FC795137F,0x5208C44932728709,0xB0AD39DBC76A30C5,0xAF1025104002BE88,0xB4601C9D1EDD1BCC,0x485DEC456869A3FC,0xB42C3394EF3FDE5F,0x479CC32E5EB6A14F,0x406306B508FA1D02,0x3723267142CEC7B3,0xD2A59899C38E053D,0xE1D9B6F57E834B93,0xA061C0EB866EA73B,0xCD583D425A899CAD,0x23B1653C139D55AF,0x6E0F464C376EDBDB,0xC5817940178574DD,0xF4E05BE521ED414D,0xE86379B1774D9341,0x1AF036ED1E533B12,0x8AAB72FC846C60DC,0x3EDDD4DAB4F18ED6,0x593C2F0200957100,0x360713F74CEF5F05,0x0AE9E4B1A814ECFB,0x1CF2E8167B1D6F05,0x9543141E8872BA37,0x93F35B4DD8C62CE5,0x8A359FF9C3F2542A,0x221EDA83A18E636C,0xAC211253D32C8B01,0xC2D7F9E67C09F641,0x51C828F159CFFC93,0xAA5118DF66784361,0x6F818F66A108E2D8,0xEC2A71F467DE9FBD,0x194F716C785F7A7A,0x94AD23E53187E953,0xCB85FF3DA1B4302E,0xC24A073275544626,0x976EC64A80E3DF8C,0xA510285D9D1CD7C9,0x2709F46E5FE21D47,0xF4276DEDC70D5563,0xC657C7A891CDA48F,0x8A505230A6EC5A7E,0x0610FB7FC7226E3C,0xB8C7138E8D52C6B5,0x08D50E94D5E69D6A,0xBC8C9BE42FBBF925,0x5134CAA6DAA38F25,0xC2861FEB78E5193D,0xE47454B0F8E71371,0xB69AADF0FF1EE75E,0xB4BF882EBDECB919,0x448EF9360452E8D4,0x8D9B8010035382B2,0x87C6590061E603BE,0x6C2043650EADE680,0x0F04A2304198318C,0x133003F632C5311F,0x9F20AC6CE28BCB72,0x507433993043A354,0x19EB76B807FA950D,0x9C8E5AC26C65E100,0x5CB1C14A3D1E5910,0x6108345341721D62,0x94D6A5D5D6CED040,0xD6032B662F2914E4,0xBF3F67DA2201B0B4,0xA301406CFFE282E4,0x0B9850756CD2B107,0xA0A518A9BA77BCE9,0xB902BC223B704CDF,0x1DDD732FBC17D422,0xE1BB0DA3AE73E2A0,0xC42FBEA7D912221A,0x66DFF460DAD2A7C6,0x2214CBDB02AFCE43,0x88272178EB319322,0x8032A56059CF9A59,0x2BA4ADB66DA7CF04,0x9AC749C8505902A6,0x9021CC74841017B3,0x655C7DCED29A42E9,0x549DA04B91512703,0xA131BFA8189388D6,0x27974235E1C7CEFA,0xC3F6A0E3418315D3,0x2B377A8ABA8976C5,0x6C81C132E114B2B7,0x94A5AD90D330C22C,0x681AE9BD9020517E,0x2911FC71DD285771,0x696900AC7F9D0D09,0xAB2F38440CA162FC,0x6A9B3069A8D68AA7,0xF8067538CAA8DF38,0xE396B4BDDAAB29DB,0xC5BCD20CB86E2F8B,0x317DACF1F4AA2E1E,0x83ECADA3A1F5C561,0x80BB6B07780F128B,0xFD525527E267EE8C,0x4B620D5DC92FC146,0xD6419075A955EFE0,0x59E7FAFB246348B8,0x8C94532220DFE8B8,0xE27BE05238B39E2B,0xAF99396EE21D83E5,0xCE3374382492C463,0x5082A6BC75BF0DAE,0x19666D4E977C365D,0x37316C0588C03EAB,0x43276D085B3F085A,0xF2CBECCE84B25B31,0xCDAA2758EAA6948E,0x638D886B6DFC458C,0x67B8EB8DA3A1882C,0xA997BE3E01DFB6DF,0x83C575668C483603,0x2A21E7A70C907760,0x0FAA22EA8FF303F3,0x28264E9B85C18B47,0x29DC4C958205F885,0x97600A3D1FC2F72E,0xE0E6828CAEE8B22F,0xE9212C14F911C102,0xD43D6D512E2D0B06,0xDE649A2330859C82,0xFDFB7F8D26096628,0xA26C7023850A3DA0,0xC5618D6A1990E044,0xF4C880ACD36F06D8,0x262ECABC653E07C5,0x8F36C0718E84827F,0x9FCC881CAB9B5944,0xFD09C33F4D67E90E,0xC7A118A7BF3ECB6E,0x7C99D473D2A20B73,0xD928D85A37E5DDC3,0x9CAF561B6FCA1DEE,0x1D5FC8C7BE7BA963,0x24EF3272FE85C2C3,0x133C60851CA61222,0x6CF665965A6B6E59,0x8BA16613EDF7640A,0x9161DD7DA7AD6C3F,0x2D47F105DC984A84,0xA1C7ED216E06562D,0xB3168ED15A60C21C,0xCABC711F96A5C6D1,0x85B7041113D5C5DF,0x3B16ADB0666107F1,0xB05B0DF78A1007F7,0x91B1DE11C073C2FA,0x2B116885B898391E,0x91C611B0A473C353,0xD32241EB6A779869,0x97ED2F1F699E0B09,0x6460C937050FEA90,0xD9D749EDD7626F03,0x6121628602558404,0xE369284CAF3BB4D2,0x3272164B20B6ACD8,0x0D674E57CE5456EB,0x4D8E97A7B6EE2A3E,0x1544C209DE0BDCFB,0x223BAE377C6F0976,0x25DE3CCAC5AED73A,0x6AF1F25A8E4A6DBD,0x37BB73CBFED7F252,0xB87A6467A2FE48D5,0x15194A4095C48E82,0xF184034C882A5220,0x9CF00EE73871D542,0x8C3A5D23CFEBEA42,0xE4F779D7C1FCD23D,0xD584813943FACD76,0xA4FECA7D70698C89,0x665824A3AAD8ADE9,0x150029EFABE96A85,0xDA0F5990F48E274A,0x376186960E90F846,0x75D532D9E17EA5B5,0x1A2BBE77E4A7851C,0xFBF1B03CF17DDBB7,0xE16F7CAB51C425F3,0x834DC465328E9BDC,0xC1F6D0F09A83484F,0x0C4D656952ABC47F,0x17A0F4335CCF00F3,0xD8CA573DDEB682DE,0x08948933CFEB4A9F,0xB1AE24C73A276FE0,0x3E03ECA3772B7A1F,0x1CB84C119A4E617E,0x2F0B7C8F3D4012B2,0x20DF40A6ABA06198,0xF689397409CC4149,0x27459EE61002E542,0x92A78BFEA193D60A,0xCEC753F4A7A088B2,0xD716550655B56D0F,0xC912AA025CA02E93,0xD10A1EF7EB75E43C,0x215507A2F34F8DDF,0xA91102AC5BA68DC0,0x6F42B9FB5CE3F1C5,0x6F7299B7325BA501,0x02269193E8DAF1E9,0x1F9C4C879B264AE6,0x3C77037EFED435E1,0x83F5830DE2C2A8DF,0xFDD0CAD23C48DAF3,0x7403C943CE0577CE,0x68CA13D3EBC3D17A,0xB1F9216470B4AED5,0xA7C5701F768EE37A,0x7246882A99E24770,0x4F48389A48288D0F,0x728D54FA51684FCA,0x07FB86E84ED681FE};

unsigned int key [] = {0x11222233, 0xAABBCCDD, 0x1A2B3C4D, 0xCC1122AA};
int rand(void)
{
    next = next * 1103515245 + 12345;
    return (unsigned int)(next/65536) % 32768;
}

void srand(unsigned int seed)
{
    next = seed;
}

unsigned char * data1;
unsigned char * data2;

void gen_data(const char * flag) {

  data1 = (unsigned char *)sbrk(4096);
  data2 = (unsigned char *)sbrk(4096);

  memset(data1, 0, 4096);
  memset(data2, 0, 4096);

  for(int i = 0; i < 32; i++) {
    srand(flag[i] + i);
    for(int j = 0; j < 128; j++) {
      data1[i * 128 + j] = rand() & 0xFF;
    }
  }

  for(int i = 0; i < 32; i++) {
    srand(flag[32 + i] + i);
    for(int j = 0; j < 128; j++) {
      data2[i * 128 + j] = rand() & 0xFF;
    }
  }
}

static void enc1(uint32_t *v, uint32_t *k) {
    uint32_t v0 = v[0], v1 = v[1], sum = 0, i;
    uint32_t delta = 0x9e3779b9;
    uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3];

    for (i = 0; i < 16; i++) {
        sum += delta;
        v0 += ((v1 << 4) + k0) ^ (v1 + sum) ^ ((v1 >> 5) + k1);
        v1 += ((v0 << 4) + k2) ^ (v0 + sum) ^ ((v0 >> 5) + k3);
    }

    v[0] = v0;
    v[1] = v1;
}

// static void enc1_rev(uint32_t *v, uint32_t *k) {
//     uint32_t v0 = v[0], v1 = v[1], sum = 0xE3779B90, i;
//     uint32_t delta = 0x9e3779b9;
//     uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3];
//     for (i = 0; i < 16; i++) {
//         v1 -= ((v0 << 4) + k2) ^ (v0 + sum) ^ ((v0 >> 5) + k3);
//         v0 -= ((v1 << 4) + k0) ^ (v1 + sum) ^ ((v1 >> 5) + k1);
//         sum -= delta;
//     }

//     v[0] = v0;
//     v[1] = v1;
// }

static void enc2(uint32_t *v, uint32_t *k) {
    uint32_t v0 = v[0], v1 = v[1], sum, i;
    sum = 0;
    uint32_t delta = 0x9e3779b9;
    uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3];
    for (i = 0; i < 8; i++) {
        v1 -= ((v0 << 4) + k2) ^ (v0 + sum) ^ ((v0 >> 5) + k3);
        v0 -= ((v1 << 4) + k0) ^ (v1 + sum) ^ ((v1 >> 5) + k1);
        sum += delta;
    }
    v[0] = v0;
    v[1] = v1;
}

// static void enc2_rev(uint32_t *v, uint32_t *k) {
//     uint32_t v0 = v[0], v1 = v[1], sum = 0xf1bbcdc8, i;
//     uint32_t delta = 0x9e3779b9;
//     uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3];
//     for (i = 0; i < 8; i++) {
//         sum -= delta;
//         v0 += ((v1 << 4) + k0) ^ (v1 + sum) ^ ((v1 >> 5) + k1);
//         v1 += ((v0 << 4) + k2) ^ (v0 + sum) ^ ((v0 >> 5) + k3);
//     }
//     v[0] = v0;
//     v[1] = v1;
// }

void enc_block1() {
  for(int i = 0 ; i < 512; i++) {
    enc1((uint32_t *)&data1[i * 8], key);
  }
}

// void enc_block2_rev() {
//   for(int i = 0 ; i < 512; i++) {
//     enc2_rev((uint32_t *)&data2[i * 8], key);
//   }
// }

// void enc_block1_rev() {
//   for(int i = 0 ; i < 512; i++) {
//     enc1_rev((uint32_t *)&data1[i * 8], key);
//   }
// }

void enc_block2() {
  for(int i = 0 ; i < 512; i++) {
    enc2((uint32_t *)&data2[i * 8], key);
  }
}

void shift(int i) {
  unsigned char tmp[256] = {0};
  memcpy(tmp, &data1[i * 256], 256);
  memcpy(&data1[i * 256], &data2[(15 - i)* 256], 256);
  memcpy(&data2[(15 - i)* 256], tmp, 256);
}

// unsigned char tmp111[4096] = {0};
// void exchange() {
//   memcpy(tmp111, data1, 4096);
//   memcpy(data1, data2, 4096);
//   memcpy(data2, tmp111, 4096);
//   //sycgame(data1, data2);
// }

void enc() {
  for (int i = 0; i < 0x10; i++) {
    enc_block1();
    enc_block2();
    shift(i);
    sycgame(data1, data2);
  }
}

// void dec() {
//     for (int i = 0xF; i >= 0; i--) {
//     exchange();
//     shift(i);
//     enc_block2_rev();
//     enc_block1_rev();
//   }
// }

void dump() {
  uint64 * data = (uint64 *) data1;
  printf("data1:\n");
  for(int i = 0; i < 512; i++) {
    printf("%p,", data[i]);
  }

  data = (uint64 *) data2;
  printf("data2:\n");
  for(int i = 0; i < 512; i++) {
    printf("%p,", data[i]);
  }

  // for(int i = 0;i < 10; i++) {
  //   printf("%x ", data1[i]);
  // }
  // printf("\n");
  // for(int i = 0;i < 10; i++) {
  //   printf("%x ", data2[i]);
  // }
  printf("\n");
}

void gift() {
  printf("gift:\n");
  srand(0x1447AABB);
  printf("\t1.%x %x %x %x\n", rand(), rand(), rand(), rand());
  printf("\t2.Fake Tea\n");
  printf("\t3.Based on xv6 2020 labs & util branch.\n");
}

int
main(int argc, char *argv[])
{
  char flagbuf[256];
  printf("Welcome SCTF2021! The new xv6 lab designed by P****OS\ncan you solve this ?\ninput:");
  gift();
  gets(flagbuf, 256);
  flagbuf[strlen(flagbuf) - 1] = 0;
  
  
  if(strlen(flagbuf) != 64) {
    printf("fail!\n");
    exit(0);
  }
  // aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
  // SCTF{xv6_nice_lab_6666_YOU_ARE_6666666_OrzzzzzzzzzzzzzrO_wowowo}
  // 96 5F D3 59 EA 2D EE 7 82 31 
  // 74 9 FF E0 6D D7 F0 B4 80 1A

// E4 D5 37 68 15 60 C5 8F C6 C 
// B6 D4 3F 4 26 C1 2A BD B A7
  gen_data(flagbuf);
 // dump();
  enc();
  //dump();
  if(memcmp(data1, data1_cmp, 4096) == 0) {
    if (memcmp(data2, data2_cmp, 4096) == 0) {
      printf("yes,you are right.!\n");
      exit(0);
    }
  }
  printf("fail! Try!");
  // dump();
  // printf("=========================\n");
  // dec();
  // dump();
  exit(0);
}
